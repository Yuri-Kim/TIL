
## Chatscript 주요 개념&예약어&연산자  

### Topic, Concept  
 - Topic : 사용자의 의도파악과 연관된 룰을 모아 놓은 논리적 묶음  
	 - Story topic  
	 - reactor topic  
	 - quibble  
 - Concept : 동의어나 유사 개념, 관련 요소의 모음  
 - canonical form : 동사, 형용사의 원형 ↔ original input(사용자 입력형)  

### Rule
 - Gambit : 말걸기
 - Responder : 응답  
 - Rejoinder : 예상 응답  
 - s: 평서문  
 - ?: 의문문  
 - !: 감탄문  
 - u: 어느 것이든 상관없음  

패턴 매칭 예시
패턴매칭? → 특정 단어나 concept이 사용자 입력문에 존재하는가를 확인   
- u: ($member know) → 사용자 변수 $member를 호출함으로써 값이 존재하는 지 확인. $member가 앞쪽에서 정의되었고 그 사용자가 know라는 단어를 사용했다면 매칭 됨  
- u: (_{석사 박사}_0) 단기 변수 → _0이 패턴에서 호출됐는데, 이것은 _0의 값이 존재하는가 확인하는 것. _0의 값이 존재하려면 사용자가 석사나 박사를 입력했어야 변수에 저장됨. 따라서 사용자가 석사 또는 박사를 입력했을 때 이 룰에 매칭 됨  

### 패턴 연산자  
 - ( ) : 나열된 단어 모두 순서대로 일치  
 -  [  ] : 나열된 단어 중 하나만 일치, 앞에서 부터 매칭을 시도하다가 매칭이 되면 그 이후의 단어에 대해서는 매칭시도를 하지 않음  
 - { } : 나열된 단어와 일치하거나 아무것도 매칭되지 않아도 괜찮음    
 - < > : 입력문의 <시작 위치 또는 >마지막 위치 에서 일치  
 - << >> : 나열된 단어 모두 순서 없이 일치(순서 없이 매칭이기 때문에 이 안에 와일드카드(*)를 사용하는 것은 의미가 없다)    
 - \* : (애스터리스크) 어떤 단어와도 매칭 되며 단어 개수 상관 없음  
 - \*\~2 : 어떤 단어와도 매칭 단어 개수 0 ~2개  
 - \*3 : 매칭 시작 위치 부터 단어 3개 매칭  (문장 맨끝에서 시작하면 매칭 실패)  
 - \*\-2 : \*2와 반대 방향, 매칭 시작 위치 부터 앞방향으로 2개 매칭  
 - 학교* : 학교에, 학교로 , 학교의 등 "학교"로 시작하는 모든 단어와 매칭  
 - 3학교* : 숫자는 총 글자수를 나타냄 총글자수가 3개인 "학교에", "학교의" 등이 매칭  
 - ! : 뒤따르는 단어가 나오면 안됨  
 - 예약어인 괄호나 느낌표등을 사용자 문장과 패턴 매칭 시키고 싶다면 앞에 역슬래시(\)를 붙임 ex. u: (<<\[*\]>>) [와 ]를 사용자 입력문의 단어와 매칭 하겠다 / u: (\!) 여기서 !는 not의 의미가 아니라 사용자 입력문에 !가 있는지 확인  

### 관계 연산자   
==, !=, <,  >, <=, >=  
관계식을 적을 때는 관계식 전체에 빈칸이 없어야 함  

### 소속 연산자  
? , !?  
- ? : 왼쪽 항목이 오른쪽 항목 내에 존재하는가 ( u: (_[ nlp vision ontology ] _0?~관심분야) 사용자가 nlp, vision, ontology 중 하나를 입력하면 그 단어가 단기기억 저장소 _0에 저장됨. 그 값이 ~관심분야 concept에 존재한느가 확인)  

?, !?를 단독으로 사용할때는 연산자 아님    
- ?  : 의문문인지 확인 ( u: (?) 혹시 질문하신건가요? 답변을 하실 차례에요. )    
- !? : 의문문이 아닌지 확인 ( u: (?!) 저는 잘 모르는 내용이에요. 다른 얘기를 해볼까요? )  

### 변수  
- _숫자 : 임시 저장용 변수 (_0 ~ _20까지 가능)  
- $user : 작성자가 만드는 변수 (변수명은 원하는 것으로)  
- %system변수 : 읽기 전용 시스템 변수 (시간, 날짜 등 다양하게 존재, 존재하는지 별도로 확인할 필요없이 필요할 때 호출해서 사용)  
- @숫자 : 지식베이스에서 검색한 결과 저장 (@0 ~ @20까지 가능)  
- ~ : concept, topic이름은 반드시 ~로 시작해야함  
- _ : 사용자 입력문 저장할 때 사용하는 임시 저장용 변수  
- $ : 사용자 입력 변수명 앞에 붙는 식별자  
- ^ : 함수 이름 똔느 인수 이름 앞에 붙는 식별자  
- 복합 명사(띄어쓰기가 있는 고유명사)는 겹따옴표("") 또는 언더바(_)로 이어씀(최대 5단어까지 가능)  
- 사용자 입력단어 저장 : 패턴에 열거한 단어 앞에 언더바(_) 붙이면 사용자가 입력한 단어중 매칭된 단어를 단기저장 변수에 기억시킴  
- < : 매칭의 시작점을 사용자 입력문의 맨 앞으로 이동시켜라  
- \> : 사용자 입력문의 가장 마지막 단어와 매칭을 시도해라  ex. u: (<제 * 입니다>) '제'는 문장의 첫단어 '입니다'는 문장의 마지막 단어여야 함  

### 주석  
- #+빈칸 : 개발자를 위한 주석  
- #!+빈칸 : 개발자와 chatscript를 위한 주석  
- ##<<, ##>> : 블럭단위 주석  

### 조건문  
- if($member) : $member변수에 값이 있나  
- if($member?) : 사용자 입력문에 $member변수에 저장된 값이 있나  
- if(_~membername ? ~mastercourse) : 사용자가 입력한 멤버명(membername)이 석사과정(mastercourse)에 속하나  

### 함수  
함수에는 시스템 함수와 사용자 정의 함수(매크로)가 있음  
- 호출 : ^ 사용 ex. ^respond()  
- refine()  
- respond(~topicname)  
- reuse(rulename)  
- join(인수들)  

**refine()**  
사용자의 질문이나 답변이 3~5개 정도의 선택 폭을 가질 때 사용  
일단 하나의 룰로 사용자 응답 캐치한 후 세부 내용에 따라 챗봇의 답변 출력하도록 2단계로 룰 작성  
u: ( ) ^refine()  
    a: ()   
    a: ()  
    a: ()  

**respond()**  
여러 곳에서 반복적으로 사용될 룰을 하나의 topic에 모은 후 그 topic을 호출하여 사용  
topic: ~MemberInfo [ ~name ~email ~course ~research ]  
u: ()  

u: ( ~member ) ^reuse( ~MemberInfo )  

**reuse()**  
호출된 룰의 출력문을 재사용하는 함수  
호출된 룰에 패턴이 포함되어 있어도 패턴 매칭 여부는 따지지 않음  
오직 호출된 룰의 출력문을 재사용하는 함수(룰이 같은 토픽에 있을 필요도 없음)  

reuse함수와 outputmacro 비교  

| 구분 | reuse() | outputmacro |  
|--|--|--|  
| 공통점 | 코드 재사용 | 코드 재사용 |  
| 인수/변수 | 전역변수 사용 | 인수 사용 |  
| 결과 값 | 전역변수에 결과 값 저장 | 결과값 되돌려 받을 수 있음 |  
| 예상 답변 | 사용 가능 | 불가능 |  
| 강제 종료 | ^end(RULE)로 종결 가능 | 불가능 |  


**join()**  
인수로 주어진 함수들을 빈칸없이 하나의 단어로 합하는 함수  
인수의 개수는 상관없으며 첫번째 인수로 "AUTOSPACE"를 지정하면 단어들을 합할 때 각 단어와 단어 사이에 빈칸을 하나씩 넣어준다  

<!--stackedit_data:
eyJoaXN0b3J5IjpbNzEzNjE5MzUxLC03MDU4NjY2MjQsLTkxNz
A3NTkzN119
-->